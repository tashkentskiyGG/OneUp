<!doctype html>
<html lang="ru">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Crash Pro TON</title>
    <style>
      * {
        box-sizing: border-box;
        margin: 0;
        padding: 0;
      }
      :root {
        --bg: #0f172a;
        --card: #1e293b;
        --accent: #2563eb;
        --green: #22c55e;
        --red: #ef4444;
        --yellow: #facc15;
      }
      body {
        font-family: -apple-system, BlinkMacSystemFont, sans-serif;
        background: var(--bg);
        color: white;
        display: flex;
        flex-direction: column;
        height: 100dvh;
        overflow: hidden;
        align-items: center;
      }
      .status-box {
        display: flex;
        justify-content: space-between;
        padding: 10px 20px;
        background: linear-gradient(135deg, #1e293b, #0f172a);
        font-weight: 700;
        font-size: 14px;
        border-radius: 12px;
        margin: 10px auto 0;
        align-items: center;
        max-width: 380px;
        width: 100%;
      }
      .status-item {
        display: flex;
        align-items: center;
        gap: 5px;
      }
      .balance-container {
        display: flex;
        align-items: center;
        gap: 5px;
      }
      .balance-container button {
        background: var(--green);
        border: none;
        color: black;
        font-weight: 700;
        border-radius: 6px;
        padding: 2px 6px;
        cursor: pointer;
      }
      .game {
        flex: 1;
        display: flex;
        flex-direction: column;
        justify-content: center;
        align-items: center;
        gap: 10px;
        position: relative;
      }
      #multiplier {
        font-size: clamp(42px, 10vw, 72px);
        font-weight: 900;
      }
      #rocket {
        font-size: clamp(40px, 8vw, 70px);
        transition: transform 0.05s linear;
      }
      .countdown {
        position: absolute;
        font-size: clamp(80px, 15vw, 150px);
        color: white;
        top: 50%;
        transform: translateY(-50%);
        display: none;
      }
      .controls {
        padding: 15px;
        display: flex;
        flex-direction: column;
        gap: 10px;
        align-items: center;
        width: 100%;
      }
      input {
        padding: 16px;
        border-radius: 14px;
        border: none;
        background: var(--card);
        color: white;
        text-align: center;
        font-size: 18px;
        width: 100%;
        max-width: 300px;
      }
      .main-btn {
        padding: 20px;
        border: none;
        border-radius: 16px;
        font-weight: 900;
        font-size: 20px;
        background: var(--accent);
        color: white;
        width: 100%;
        max-width: 380px;
      }
      .main-btn.green {
        background: var(--green);
        color: black;
      }
      .history {
        display: flex;
        gap: 6px;
        flex-wrap: wrap;
        justify-content: center;
        padding: 8px 0;
      }
      .history span {
        padding: 4px 8px;
        border-radius: 6px;
        font-size: 12px;
        background: var(--card);
      }
      .bottom-buttons {
        display: flex;
        justify-content: center;
        gap: 10px;
        margin-top: 10px;
        width: 100%;
        max-width: 380px;
      }
      .bottom-buttons button {
        padding: 14px 20px;
        border-radius: 12px;
        border: none;
        background: var(--card);
        color: white;
        font-weight: 700;
        cursor: pointer;
        flex: 1;
      }
      .explosion {
        font-size: 80px;
        pointer-events: none;
        opacity: 0;
        animation: explode 0.6s forwards;
      }
      @keyframes explode {
        0% {
          transform: scale(1);
          opacity: 1;
        }
        50% {
          transform: scale(2);
          opacity: 0.8;
        }
        100% {
          transform: scale(0.5);
          opacity: 0;
        }
      }
    </style>
  </head>
  <body>
    <div class="status-box">
      <div class="status-item">üë• –û–Ω–ª–∞–π–Ω: <span id="online">96</span></div>
      <div class="status-item balance-container">
        <span id="balance">100 TON</span>
        <button id="addBalance">+</button>
      </div>
    </div>

    <div class="game">
      <div id="multiplier">1.00x</div>
      <div id="rocket">üöÄ</div>
      <div class="countdown" id="countdown"></div>
    </div>

    <div class="controls">
      <div class="history" id="history"></div>
      <input type="number" id="betInput" placeholder="–°—Ç–∞–≤–∫–∞" />
      <button class="main-btn" id="mainBtn">–°—Ç–∞–≤–∫–∞</button>
      <div class="bottom-buttons">
        <button id="btnLeft">–í—ã–≤–æ–¥</button>
        <button id="btnCenter">Crash</button>
        <button id="btnRight">–ü—Ä–æ—Ñ–∏–ª—å</button>
      </div>
    </div>

    <script>
      let balance = 100,
        bet = 0,
        multiplier = 1,
        crashPoint = 0,
        gameRunning = false,
        playerCashOut = false,
        historyArr = [];

      // –û–Ω–ª–∞–π–Ω
      function updateOnline() {
        let online = document.getElementById("online");
        let current = parseInt(online.innerText);
        let change = Math.floor(Math.random() * 5) - 2;
        current = Math.min(180, Math.max(60, current + change));
        online.innerText = current;
      }
      setInterval(updateOnline, 2000);

      // –ë–∞–ª–∞–Ω—Å
      function updateBalance() {
        document.getElementById("balance").innerText =
          balance.toFixed(2) + " TON";
      }

      // –ò—Å—Ç–æ—Ä–∏—è
      function addHistory(x) {
        historyArr.unshift(x.toFixed(2));
        if (historyArr.length > 15) historyArr.pop();
        const h = document.getElementById("history");
        h.innerHTML = "";
        historyArr.forEach((v) => {
          const s = document.createElement("span");
          s.innerText = v + "x";
          s.style.color = v < 2 ? "#ef4444" : v < 5 ? "#facc15" : "#22c55e";
          h.appendChild(s);
        });
      }

      // –û—Ç—Å—á—ë—Ç
      function startCountdown() {
        document.getElementById("rocket").style.display = "none";
        document.getElementById("multiplier").innerText = "";
        let count = 5;
        const el = document.getElementById("countdown");
        el.style.display = "block";
        el.innerText = count;
        const t = setInterval(() => {
          count--;
          if (count > 0) el.innerText = count;
          else {
            clearInterval(t);
            el.style.display = "none";
            startGame();
          }
        }, 1000);
      }

      // –°–∏—Å—Ç–µ–º–∞ –∫–æ—ç—Ñ—Ñ–∏—Ü–∏–µ–Ω—Ç–æ–≤
      function randomCrash() {
        let rand = Math.random();
        if (rand < 0.35) {
          // 35% ‚Äî –º–∞–ª–µ–Ω—å–∫–∏–µ
          const small = [1.2, 1.5, 1.8];
          return small[Math.floor(Math.random() * small.length)];
        } else if (rand < 0.8) {
          // 45% ‚Äî —Å—Ä–µ–¥–Ω–∏–µ
          return +(Math.random() * 8 + 2).toFixed(2); // 2-10x
        } else {
          // 20% ‚Äî –±–æ–ª—å—à–∏–µ
          const big = [20, 50, 80, 100];
          return big[Math.floor(Math.random() * big.length)];
        }
      }

      function startGame() {
        multiplier = 1;
        crashPoint = randomCrash();
        gameRunning = true;
        playerCashOut = false;
        document.getElementById("multiplier").innerText = "1.00x";
        document.getElementById("rocket").style.display = "block";
        let lastTime = performance.now();

        function loop(time) {
          if (!gameRunning) return;
          const delta = (time - lastTime) / 1000;
          lastTime = time;
          multiplier *= 1 + 0.4 * delta;
          multiplier = Math.max(multiplier, 1);
          document.getElementById("multiplier").innerText =
            multiplier.toFixed(2) + "x";
          document.getElementById("rocket").style.transform =
            "translateY(" +
            -multiplier * 4 +
            "px) scale(" +
            (1 + multiplier / 20) +
            ")";
          if (multiplier >= crashPoint) {
            crash();
            return;
          }
          requestAnimationFrame(loop);
        }
        requestAnimationFrame(loop);
      }

      function createExplosion() {
        const rocket = document.getElementById("rocket");
        const rect = rocket.getBoundingClientRect();
        const explosion = document.createElement("div");
        explosion.className = "explosion";
        explosion.style.position = "fixed";
        explosion.style.left = rect.left + rect.width / 2 - 40 + "px";
        explosion.style.top = rect.top + rect.height / 2 - 40 + "px";
        explosion.innerText = "üí•";
        document.body.appendChild(explosion);
        setTimeout(() => explosion.remove(), 600);
      }

      function crash() {
        gameRunning = false;
        createExplosion();
        document.getElementById("rocket").style.display = "none";
        document.getElementById("multiplier").innerText = "";
        addHistory(crashPoint);
        bet = 0;
        resetButton();
        setTimeout(startCountdown, 700);
      }

      function placeBet() {
        if (gameRunning) return;
        const amount = parseFloat(document.getElementById("betInput").value);
        if (!amount || amount <= 0 || amount > balance) return;
        bet = amount;
        balance -= amount;
        updateBalance();
        document.getElementById("mainBtn").classList.add("green");
        document.getElementById("mainBtn").innerText = "–ó–∞–±—Ä–∞—Ç—å";
      }

      function cashOut() {
        if (!gameRunning || bet <= 0 || playerCashOut) return;
        const win = bet * multiplier;
        balance += win;
        updateBalance();
        addHistory(multiplier);
        playerCashOut = true;
        resetButton();
      }

      function resetButton() {
        document.getElementById("mainBtn").classList.remove("green");
        document.getElementById("mainBtn").innerText = "–°—Ç–∞–≤–∫–∞";
      }

      document.getElementById("mainBtn").onclick = () => {
        if (document.getElementById("mainBtn").classList.contains("green"))
          cashOut();
        else placeBet();
      };

      // –ü–æ–ø–æ–ª–Ω–µ–Ω–∏–µ –±–∞–ª–∞–Ω—Å–∞
      document.getElementById("addBalance").onclick = () => {
        balance += 50;
        updateBalance();
      };

      updateBalance();
      startCountdown();
    </script>
  </body>
</html>
