<!Doctype html>
<html>
  <head>
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Crash Game Cool</title>
    <style>
      body {
        margin: 0;
        background: radial-gradient(circle at top, #0f172a, #111827);
        font-family: Arial, sans-serif;
        color: white;
        display: flex;
        flex-direction: column;
        height: 100vh;
        overflow: hidden;
      }
      .top {
        display: flex;
        justify-content: center;
        align-items: center;
        font-size: 22px;
        font-weight: bold;
        padding: 15px;
      }
      .balance {
        color: #22c55e;
      }
      .game {
        flex: 1;
        display: flex;
        flex-direction: column;
        align-items: center;
        justify-content: center;
        position: relative;
      }
      #rocket {
        font-size: 60px;
        transition: transform 0.1s linear;
      }
      #multiplier {
        font-size: 42px;
        font-weight: bold;
        margin: 10px 0;
      }
      #history {
        display: flex;
        gap: 8px;
        flex-wrap: wrap;
        justify-content: center;
        margin-top: 20px;
      }
      .history-item {
        background: rgba(255, 255, 255, 0.1);
        padding: 6px 12px;
        border-radius: 8px;
        font-size: 16px;
      }
      .bottom {
        background: #111827;
        padding: 15px;
        display: flex;
        flex-direction: column;
        gap: 10px;
      }
      input {
        padding: 10px;
        font-size: 16px;
        border-radius: 8px;
        border: none;
      }
      button {
        padding: 12px;
        font-size: 16px;
        border: none;
        border-radius: 10px;
        font-weight: bold;
        cursor: pointer;
      }
      .betBtn {
        background: #2563eb;
        color: white;
      }
      .cashBtn {
        background: #22c55e;
        color: black;
      }
      .countdown {
        font-size: 18px;
        color: #facc15;
        margin-top: 10px;
      }
    </style>
  </head>
  <body>
    <div class="top">üíé –ë–∞–ª–∞–Ω—Å: <span id="balance">100</span></div>

    <div class="game">
      <div id="multiplier">1.00x</div>
      <div id="rocket">üöÄ</div>
      <div class="countdown" id="countdown"></div>
      <div id="history"></div>
    </div>

    <div class="bottom">
      <input type="number" id="betInput" placeholder="–°—Ç–∞–≤–∫–∞ (–∫—Ä–∏—Å—Ç–∞–ª–ª—ã)" />
      <button class="betBtn" onclick="placeBet()">–°–¥–µ–ª–∞—Ç—å —Å—Ç–∞–≤–∫—É</button>
      <button class="cashBtn" onclick="cashOut()">–ó–∞–±—Ä–∞—Ç—å</button>
    </div>

    <script src="https://telegram.org/js/telegram-web-app.js"></script>
    <script>
      let balance = 100;
      let bet = 0;
      let gameRunning = false;
      let multiplier = 1;
      let crashPoint = 0;
      let interval;
      let history = [];

      const tg = window.Telegram.WebApp;
      tg.expand();

      function updateBalance() {
        document.getElementById("balance").innerText = balance;
      }

      function randomCrash() {
        return (Math.random() * 4 + 1).toFixed(2);
      }

      function addHistory(value) {
        history.unshift(value);
        if (history.length > 10) history.pop();
        const historyDiv = document.getElementById("history");
        historyDiv.innerHTML = "";
        history.forEach((v) => {
          const div = document.createElement("div");
          div.className = "history-item";
          div.innerText = v + "x";
          historyDiv.appendChild(div);
        });
      }

      function startCountdown() {
        let count = 3;
        document.getElementById("countdown").innerText = "–°—Ç–∞—Ä—Ç —á–µ—Ä–µ–∑ " + count;
        let timer = setInterval(() => {
          count--;
          document.getElementById("countdown").innerText =
            "–°—Ç–∞—Ä—Ç —á–µ—Ä–µ–∑ " + count;
          if (count <= 0) {
            clearInterval(timer);
            document.getElementById("countdown").innerText = "";
            startGame();
          }
        }, 1000);
      }

      function startGame() {
        gameRunning = true;
        multiplier = 1;
        crashPoint = randomCrash();

        interval = setInterval(() => {
          multiplier += 0.02;
          document.getElementById("multiplier").innerText =
            multiplier.toFixed(2) + "x";
          document.getElementById("rocket").style.transform =
            "translateY(-" + multiplier * 5 + "px)";

          if (multiplier >= crashPoint) {
            clearInterval(interval);
            gameRunning = false;
            document.getElementById("multiplier").innerText =
              "üí• BOOM " + crashPoint + "x";
            addHistory(crashPoint);
            bet = 0;
            document.getElementById("rocket").style.transform =
              "translateY(0px)";
            setTimeout(startCountdown, 2000);
          }
        }, 100);
      }

      function placeBet() {
        if (gameRunning) return;
        let amount = parseInt(document.getElementById("betInput").value);
        if (!amount || amount <= 0) {
          alert("–í–≤–µ–¥–∏—Ç–µ —Å—Ç–∞–≤–∫—É");
          return;
        }
        if (amount > balance) {
          alert("–ù–µ–¥–æ—Å—Ç–∞—Ç–æ—á–Ω–æ –∫—Ä–∏—Å—Ç–∞–ª–ª–æ–≤");
          return;
        }
        bet = amount;
        balance -= amount;
        updateBalance();
      }

      function cashOut() {
        if (!gameRunning || bet <= 0) return;
        clearInterval(interval);
        gameRunning = false;

        let win = bet * multiplier;
        balance += Math.floor(win);
        updateBalance();

        document.getElementById("multiplier").innerText =
          "–ó–∞–±—Ä–∞–Ω–æ " + Math.floor(win);
        addHistory(multiplier.toFixed(2));
        document.getElementById("rocket").style.transform = "translateY(0px)";

        bet = 0;
        setTimeout(startCountdown, 2000);
      }

      updateBalance();
      startCountdown();
    </script>
  </body>
</html>
